BigQuery Job User (necess√°rio para rodar queries)
BigQuery Data Viewer (para visualizar dados)
BigQuery User (combina permiss√µes de visualiza√ß√£o e execu√ß√£o de jobs)



Nome do campo
Tipo
Modo
Chave
Compila√ß√£o
Valor padr√£o
Tags de pol√≠ticas
Descri√ß√£o
ano
INTEGER	REQUIRED	-	-	-	
-
-
id_escola
STRING	NULLABLE	-	-	-	
-
-
id_regiao
STRING	NULLABLE	-	-	-	
-
-
escola_publica
INTEGER	NULLABLE	-	-	-	
-
-
desempenho_aluno
STRING	NULLABLE	-



 Como resolver?
üîë Solu√ß√£o recomendada: Use inser√ß√£o via carga (load job), que √© suportada no free tier.
Diferen√ßa entre streaming e load job:

Inser√ß√£o via API (Streaming)	Inser√ß√£o via Load Job
Dados em tempo real	Dados processados em lotes
üö´ Bloqueado no free tier	‚úÖ Permitido no free tier
Usado para eventos em tempo real	Ideal para ETLs e cargas peri√≥dicas

Transforma√ß√£o conclu√≠da. Registros: 28897071, Colunas: 268

'''
WITH dados_filtrados AS (
  SELECT
    ano,
    id_regiao,
    SAFE_CAST(desempenho_disciplina AS NUMERIC) AS desempenho
  FROM `basedosdados.br_inep_saeb.aluno_ef_9ano`
  WHERE ano BETWEEN 1995 AND 2021
    AND desempenho_disciplina IS NOT NULL
    AND id_regiao IS NOT NULL
)
SELECT
  ano,
  id_regiao,
  AVG(desempenho) AS media_desempenho,
  COUNT(*) AS total_alunos
FROM dados_filtrados
GROUP BY ano, id_regiao
ORDER BY ano, media_desempenho DESC;
#################################################################################

WITH dados_filtrados AS (
  SELECT
    ano,
    sigla_uf,
    SAFE_CAST(desempenho_disciplina AS NUMERIC) AS desempenho
  FROM `basedosdados.br_inep_saeb.aluno_ef_9ano`
  WHERE ano BETWEEN 1995 AND 2021
    AND desempenho_disciplina IS NOT NULL
    AND id_regiao IS NOT NULL
)
SELECT
  ano,
  sigla_uf,
  AVG(desempenho) AS media_desempenho,
  COUNT(*) AS total_alunos
FROM dados_filtrados
GROUP BY ano, sigla_uf
ORDER BY ano, media_desempenho DESC;
'''